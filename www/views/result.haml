
%h3.job_info 
  Job:
  %span#name== #{ @jobname }
  %a#download_results(href="/download/#{ @job }" target='_blank') [download results]
  %a#original_input(href="/original/#{ @job }" target='_blank') [original input]
  
  - if @filtered and @filtered.any?
    %a#filtered(href="/filtered/#{ @job }" target='_blank')== filtered proteins (#{@filtered.size})



%table#predictions.tablesorter
  %thead
    %tr
      %th Protein
      %th Mutation
      %th Kinase Group
      %th Score
      %th Prediction*
      %th Features
  %tbody
    - @res.sort_by{|mutation,value| @list.index mutation.sub('#','')}.each do |mutation,values|
      - mutation = mutation.sub('#', '')
      - prot, m = mutation.split(/_/)

      %tr
        %td
          - names = [@translations[prot], @translations_id[prot]] - [prot]
          = names * ", "
          %a(href="http://www.uniprot.org/uniprot/#{ prot }" target='_blank')= prot
        - wt = Kinase.error_in_wt_aa?(prot, m)
        - if wt.nil? or wt
          %td
            - first, *rest = m.split('')
            = "<font color='red'>#{first}</font>#{rest}"
            - if wt.nil?
              %span.wt_error== position outside protein range
            - else
              %span.wt_error== expected wild-type aa (#{Kinase.error_in_wt_aa?(prot, m)})
            
        - else
          %td= m
        %td= @uniprot_groups[mutation]
        %td= "%1.3g" % (values[1].first.to_f)
        %td 
          - if values[1].first.to_f < -0.5  
            %span.neutral Neutral 
          - else
            %span.damaging Damaging
        %td.features 
          %a(href="/details/#{@job}/#{prot}/#{m}") details

%p.note * Threshold is on -0.5

:javascript
  $('#predictions').tablesorter({widgets: ['zebra']});
  //$('table#predictions > tbody > tr').mouseover(function(){$(this).addClass('highligted')})
  //$('table#predictions > tbody > tr').mouseout(function(){$(this).removeClass('highligted')})
